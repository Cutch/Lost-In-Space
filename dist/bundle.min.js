function lis(){const _t={"a":"right","b":"24px Arial","c":"#fff","d":"center","e":"addEventListener","f":"prototype","g":"position","h":"height","i":"fillStyle","j":"fillRect","k":"canvas","l":"forEach","m":"statusText","n":"createOscillator","o":"exponentialRampToValueAtTime","p":"currentTime","q":"background"};const _s=setTimeout;const _m=Math;const Xb=_m.random;const Xa=_m.floor;const _d=document;const _a=window[_t.e];let t,e,s={};function i(t,...e){(s[t]||[]).map(t=>t(...e))}function n(){return e}const h=()=>{};class r{constructor(t=0,e=0,s={}){this.x=t,this.y=e}add(t){return new r(this.x+t.x,this.y+t.y,this)}}function o(){return new r(...arguments)}o[_t.f]=r[_t.f],o.t=r;class a extends class{constructor(t){return this.init(t)}init(t={}){this[_t.g]=o(),this.s=o(),Object.assign(this,t)}update(t){this.advance(t)}advance(t){let e=this.s;this[_t.g]=this[_t.g].add(e),this.i()}get dx(){return this.s.x}get dy(){return this.s.y}set dx(t){this.s.x=t}set dy(t){this.s.y=t}i(){}}{init({width:t=0,height:e=0,_c:s=n(),h:i=this.o,update:h=this.advance,anchor:r={x:0,y:0},_r:o=0,...a}={}){super.init({width:t,height:e,_c:s,anchor:r,_r:o,...a}),this.l=1,this.u(),this.p=i,this.g=h}h(t){let e=this._c;e.save(),(this.x||this.y)&&e.translate(this.x,this.y),this._r&&e.rotate(this._r);let s=-this.width*this.anchor.x,i=-this[_t.h]*this.anchor.y;(s||i)&&e.translate(s,i),this.p(),(s||i)&&e.translate(-s,-i),e.restore()}o(){}i(t,e){this.u()}get x(){return this[_t.g].x}get y(){return this[_t.g].y}set x(t){this[_t.g].x=t,this.i()}set y(t){this[_t.g].y=t,this.i()}get width(){return this.M}set width(t){this.M=t,this.i()}get height(){return this.m}set height(t){this.m=t,this.i()}u(){if(!this.l)return;let{A:t=0,v:e=0,S:s=0}=this.parent||{};this.A=this.x,this.v=this.y,this.C=this.width,this.T=this[_t.h],this.S=s+this._r;let{x:i,y:n}=function(t,e){let s=_m.sin(e),i=_m.cos(e);return{x:t.x*i-t.y*s,y:t.x*s+t.y*i}}({x:this.x,y:this.y},s);this.A=i,this.v=n}get k(){return{x:this.A,y:this.v,width:this.C,height:this.T,_r:this.S}}get _r(){return this._}set _r(t){this._=t,this.i()}}function c(){return new a(...arguments)}c[_t.f]=a[_t.f],c.t=a;class l extends c.t{init({...t}={}){super.init({...t})}o(){this.color&&(this._c[_t.i]=this.color,this._c[_t.j](0,0,this.width,this[_t.h]))}}function u(){return new l(...arguments)}u[_t.f]=l[_t.f],u.t=l;let d=/(\d+)(\w+)/;class f extends c.t{init({text:t="",textAlign:e="",lh:s=1,font:i=n().font,...h}={}){super.init({text:t,textAlign:e,lh:s,font:i,...h}),this.H()}get width(){return this.M}set width(t){this.I=1,this.M=t,this.$=t}get text(){return this.F}set text(t){this.I=1,this.F=t}get font(){return this.D}set font(t){this.I=1,this.D=t,this.W=function(t){let e=t.match(d),s=+e[1];return{size:s,U:e[2],L:s}}(t).L}get lh(){return this.q}set lh(t){this.I=1,this.q=t}h(){this.I&&this.H(),super.h()}H(){this.P=[],this.I=0;let t=this._c;t.font=this.font,this.P.length||(this.P.push(this.text),this.M=this.$||t.measureText(this.text).width),this[_t.h]=this.W+(this.P.length-1)*this.W*this.lh,this.u()}o(){let t=this.textAlign,e=this._c;this.P.map((s,i)=>{e.textBaseline="top",e.textAlign=t,e[_t.i]=this.color,e.font=this.font,e.fillText(s,0,this.W*this.lh*i)})}}function w(){return new f(...arguments)}function p(t){let e=t[_t.k];t.clearRect(0,0,e.width,e[_t.h])}w[_t.f]=f[_t.f],w.t=f;let x={},g={},M={Enter:"enter",Space:"space"};function y(t){let e=M[t.code];g[e]=1,x[e]&&x[e](t)}function m(t){g[M[t.code]]=0}function A(){g={}}function v(t){return!!g[t]}const S=(t,e)=>_m.sqrt(_m.pow(t.x-e.x,2)+_m.pow(t.y-e.y,2)),C=(t,e)=>_m.sqrt(_m.pow(t,2)+_m.pow(e,2)),T=(t,e)=>_m.atan2(e.y-t.y,e.x-t.x)+_m.PI/2,k="Fire Rate Upgrade",E="Speed Upgrade",_="Hull Repaired",H="Warp Drive Fixed, Warping in 3, 2, 1...",b=t=>Array.apply(null,Array(t)).map((t,e)=>e);class I extends c.t{constructor(t){super(t)}o(){const t=this._c;t[_t.i]="#000",t[_t.j](-this.x,-this.y,t[_t.k].width,t[_t.k][_t.h]),t[_t.i]=_t.c,b(Xa(t[_t.k].width*t[_t.k][_t.h]*1e-4))[_t.l](e=>t[_t.j](-this.x+(this.x+(2*_m.pow(e,3)+20*e))%t[_t.k].width,-this.y+(this.y+(2*_m.pow(e,3)+20*e))%t[_t.k][_t.h],e%3+1,e%3+1))}}const $={font:_t.b,color:_t.c,textAlign:_t.a};class F extends c.t{R=[];N=1;O=0;constructor(t){super(t);this.X=new w($),this.Y=new w($),this.j=new w($),this.B=new w({font:"12px Arial",color:_t.c,text:"Press SPACE to skip"}),this.G=new u({color:"#6009"})}K(t){this.O=t}h(){const t=this;t.X.h(),t.Y.h(),t.j.h(),t[_t.m]&&(t.G.h(),t[_t.m].h(),t.O&&t.B.h())}J(t,e=6e3){this.R.push([t,e]),this[_t.m]||this.V()}V(){if(clearTimeout(this.Z),this.R.length>0){const[t,e]=this.R.shift();this[_t.m]=new w({font:_t.b,color:_t.c,text:t,textAlign:_t.d,x:this._c[_t.k].width/2,y:20}),this.Z=_s(()=>this.V(),e)}else this[_t.m]=null}update(t){const e=this,s=e._c[_t.k].width,i=e._c[_t.k][_t.h];e.X.x=s-20,e.X.y=i-20-24,e.Y.x=s-20,e.Y.y=i-45-20-24,e.j.x=s-20,e.j.y=i-90-20-24,e.Y.text=`Scrap: ${t.tt}t`,e.X.text="Day: "+t.et,e.j.text=`Hull Integrity: ${t.st}%`,e[_t.m]&&(e.G.width=s,e.G[_t.h]=64,e[_t.m].x=s/2,e[_t.m].y=20,e.O&&(e.B.x=s/2+150,e.B.y=47))}}class D extends u.t{constructor(t){super(t={...t,width:2,height:10,color:"#abab46",it:0})}update(t){super.update(),t.filter(t=>(({x:t,y:e},{x:s,y:i,width:n,height:h})=>t>s-n/2&&t<s+n/2&&e>i-h/2&&e<i+h/2)(this,t))[_t.l](t=>{this.it=1,t.nt(),t.st<=0&&this._c[_t.k].dispatchEvent(new CustomEvent("eh",{detail:t}))})}}const W=window.AudioContext||window.webkitAudioContext;let L=()=>{},U=()=>{},q=()=>{},P=()=>{};if(W){const t=new W;let e,s,i;L=()=>{const e=t[_t.n]();e.type="square";const s=t.createGain();s.gain.value=.5,s.gain[_t.o](1e-4,t[_t.p]+.04),e.frequency.value=100,e.connect(s),s.connect(t.destination),e.start(),_s(()=>e.stop(),100)},U=()=>{const e=t[_t.n]();e.type="sawtooth";const s=t.createGain();s.gain.value=.5,s.gain[_t.o](1e-4,t[_t.p]+.15),e.frequency.value=50,e.connect(s),s.connect(t.destination),e.start(),_s(()=>e.stop(),150)},q=n=>{if(clearTimeout(i),e)s.cancelScheduledValues(t[_t.p]),s.setValueAtTime(.1,t[_t.p]);else{const i=t.createBiquadFilter();i.type=0,i.Q.value=20,e=[t[_t.n](),t[_t.n]()];const[h,r]=e;h.frequency.value=10*n,r.frequency.value=25,e[_t.l]((t,e)=>{t.type="triangle",t.connect(i),t.start(0)});const o=t.createGain();s=o.gain,s.value=.1,i.connect(o),o.connect(t.destination)}},P=()=>{s&&(s.setValueAtTime(s.value,t[_t.p]),s[_t.o](1e-5,t[_t.p]+.02)),i=_s(()=>{e&&e[_t.l](t=>t.stop()),e=null},20)},_a("keydown",()=>{t.resume()})}const R=[30,0,22.5,15,20,30,0,45,0,57,15,60,45,60,60,57,60,45,40,30,37.5,15],z=(t,e,s,i,n,h,r=n)=>{t.beginPath(),t.moveTo(e,s),t.lineTo(i,n),t.lineTo(h,r),t.fill()};class N extends c.t{ht=4;rt=0;ot=0;at=[];ct=20;lt=-20;level=1;ut=1;et=0;tt=0;dt=0;constructor(t){super({width:60,height:60,ft:0,wt:0,st:100,anchor:{x:.5,y:.5}});const e=this,s=e._c;e.pt=t,e.xt=s.createLinearGradient(0,0,0,80),e.xt.addColorStop(.6,"#f00"),e.xt.addColorStop(1,"#600"),e.color=this._c.createPattern((()=>{const t=_d.createElement("canvas"),e=t.getContext("2d");return t.width=60,t[_t.h]=60,e[_t.i]="#888",e[_t.j](0,0,60,60),e[_t.i]="#444",z(e,40,30,50,60,80),z(e,20,30,10,60,-20),e[_t.i]="#777",z(e,30,5,20,50,40),e[_t.i]="#666",z(e,30,5,20,40,40),e[_t.i]="#222",z(e,30,15,25,35,35),t})(),"repeat"),e.gt=[[20,()=>e.ct=15,k],[40,()=>(e.ht=5.5,e.ut++),E],[60,()=>e.ct=10,k],[80,()=>(e.ht=6.5,e.ut++),E],[100,()=>e.st=_m.min(100,e.st+50),_],[120,()=>e.ct=5,k],[140,()=>(e.ht=7.5,e.ut++),E],[200,()=>e.rt=1,H]],s[_t.k][_t.e]("eh",()=>{e.tt++,e.gt[_t.l](([s,i,n])=>{s===e.tt&&(e.level++,i(),t.J(n))})})}o(){const t=this,e=t._c;e[_t.i]=t.color,e.beginPath();for(let t=0;t<R.length;t+=2)e.lineTo(R[t],R[t+1]);if(e.fill(),t.ot){e[_t.i]=t.xt,e.beginPath();const s=Xb(),i=Xa(2*_m.pow(t.ht/2,2));b(13)[_t.l](n=>e.lineTo(15+t.width/2/12*n,60+n%2*(2*i-s*i*_m.sqrt(_m.abs(n/2-3))))),e.fill()}}h(){super.h(),this.at[_t.l](t=>t.h())}update(t,e){const s=this;s.at[_t.l]((i,n)=>{i.Mt<e-80||i.it?s.at.splice(n,1):i.update(t)}),s.et=Xa(e/600),t.filter(t=>S({x:s.x,y:s.y},t)<55)[_t.l](t=>{U(),s.st-=10,s._c[_t.k].dispatchEvent(new CustomEvent("eh",{detail:t}))});const i=s.ot;if(s.ot=v("w"),s.ot&&!i?q(s.ut):!s.ot&&i&&P(),v("space")&&e-s.lt>=s.ct&&(L(),s.lt=e,s.yt(e)),v("w")){s.ft+=.05*-_m.sin(s._r),s.wt+=.05*_m.cos(s._r);const t=C(s.ft,s.wt);t>s.ht&&(s.ft*=s.ht/t,s.wt*=s.ht/t)}const n=.05/(this.dt?1:2);v("a")?(s._r=s._r-n,this.dt=1):v("d")?(s._r=s._r+n,this.dt=1):this.dt=0}yt(t){this.at.push(new D({dx:10*_m.sin(this._r),dy:10*-_m.cos(this._r),x:this.x+40*_m.sin(this._r),y:this.y-40*_m.cos(this._r),_r:this._r,Mt:t}))}}const O=(t,e)=>{const s=_d.createElement("canvas"),i=s.getContext("2d");s.width=40,s[_t.h]=40,i[_t.i]=t,i[_t.j](0,0,40,40);const n=(h=e+1,()=>(h=1e4*_m.sin(h))-Xa(h));var h;for(let t=0,e=0;e<40;){const s=Xa(7*n()+2);i[_t.i]=n()<.5?"#333":"#222",i[_t.j](t,e,s,Xa(7*n()+2)),t+=1+s,t>40&&(e+=5,t=0)}return s},X=b(15).reduce((t,e)=>[...t,...["#080","#008","#800"].map(t=>O(t,e))],[]);class Y extends u.t{constructor(t){super(t={...t,width:40,height:40,ft:0,wt:0,anchor:{x:.5,y:.5}}),this.type=3*Xa(15*Xb()),this.At=X.map(t=>this._c.createPattern(t,null)),this.st++,this.nt()}nt(){this.st--,this.st>0&&(this.color=this.At[this.st-1+this.type])}update(t){const e=this,s=t.reduce((t,s)=>{if(s!==e){const i=S(e,s);if(i<t.vt){return{angle:T(e,s)+180,vt:i}}}return t},{vt:100,angle:0});let i=T(e,e.St);100!==s.vt&&(i=s.angle+i/2),e.ft-=.1*_m.sin(i),e.wt+=.1*_m.cos(i);const n=C(e.ft,e.wt),h=e.St.et,r=_m.min(h/8,5)+5;n>r&&(e.ft*=r/n,e.wt*=r/n),e.dx-=e.ft,e.dy-=e.wt,super.update()}}const j="36px Arial",B=t=>1!==t?"s":"";class G extends c.t{Ct=0;constructor(t,e){super(),P();const s=this;s[_t.q]=new u({width:600,height:400,color:"#600A"}),s.Tt=new w({font:_t.b,color:_t.c,text:"Me: These are the coordinates, where's Earth?",textAlign:_t.d}),s.kt=new w({font:_t.b,color:_t.c,text:"Computer: Error: 404. Earth not found.",textAlign:_t.d}),s.Et=new w({font:j,color:_t.c,text:"Game Over",textAlign:_t.d}),s._t=new w({font:j,color:_t.c,text:"Score: "+t.tt,textAlign:_t.d});const i=window.localStorage;if(i){const e=_m.max(i.getItem("lins_score")||0,t.tt),n=i.getItem("lins_day")||0,h=t.tt>=200?_m.min(n,t.et):n;i.setItem("lins_score",e),i.setItem("lins_day",n),s.Ht=new w({font:"18px Arial",color:_t.c,text:`High Score: ${h} day${B(h)}, ${e} scrap`,textAlign:_t.d})}s.X=new w({font:j,color:_t.c,text:`${e?"Completed in":"Lasted"}: ${t.et} day${B(t.et)}`,textAlign:_t.d}),s.bt=new w({font:j,color:_t.c,text:"Play Again? Press Enter",textAlign:_t.d}),s.Ct=e}h(){const t=this;t[_t.q].h(),t.Ct?(t.Tt.h(),t.kt.h()):t.Et.h(),t._t.h(),t.X.h(),t.Ht&&t.Ht.h(),t.bt.h()}update(){const t=this,e=t._c[_t.k].width/2,s=t._c[_t.k][_t.h]/2;t[_t.q].x=e-t[_t.q].width/2,t[_t.q].y=s-t[_t.q][_t.h]/2,t.Tt.x=e,t.Tt.y=s-132,t.kt.x=e,t.kt.y=s-104,t.Et.x=e,t.Et.y=s-112,t._t.x=e,t._t.y=s-56,t.X.x=e,t.X.y=s,t.Ht&&(t.Ht.x=e,t.Ht.y=s+56),t.bt.x=e,t.bt.y=s+112}}const{canvas:K}=function(s){return t=_d.getElementById(s)||s||_d.querySelector("canvas"),e=t.getContext("2d"),e.It=0,i("init"),{canvas:t,_c:e}}();function J(){const t=_d.getElementsByTagName("canvas")[0];t.width=window.innerWidth,t[_t.h]=window.innerHeight}_a("resize",J,0),J(),function(){let t;for(t=0;t<26;t++)M[t+65]=M["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)M[48+t]=M["Digit"+t]=""+t;_a("keydown",y),_a("keyup",m),_a("blur",A)}();let Q,V,Z,tt,et,st,it,nt=new w({color:"#600D",font:"70px Arial",textAlign:_t.d,text:"Lost In Space",x:K.width/2,y:K[_t.h]/4});const ht=()=>{Q=1,V=null,Z=new F,tt=new I,et=new N(Z),it=1,st=[],["Me: Where am I?","Computer: Error: 404. Location Not Found.","Me: It looks like I have drifted for 10 warp days. I will have to find my way back.","Me: This may be Corg space, I don't want to get assimil...assinated.","Me: Computer, System Status.","Computer: All systems have been destroyed.","Me: Ugh, now I need some scrap to fix the systems.","Computer: 200t of scrap are needed","Computer: Use my WASD keys to fly and The Bar to shoot."][_t.l](t=>Z.J(t,_m.max(t.split(" ").length,6)/150*6e4))};ht();let rt=1;const ot=function({$t:t=60,Ft:e=1,update:s=h,h:r,_c:o=n()}={}){let a,c,l,u,d,f=0,w=1e3/t,x=1/t,g=e?p:h;function M(){if(c=requestAnimationFrame(M),l=performance.now(),u=l-a,a=l,!(u>1e3)){for(i("tick"),f+=u;f>=w;)d.update(x),f-=w;g(o),d.h()}}return d={update:s,h:r,Dt:1,start(){a=performance.now(),this.Dt=0,requestAnimationFrame(M)},stop(){this.Dt=1,cancelAnimationFrame(c)}},d}({Ft:0,update:()=>{V?(V.update(),v("enter")&&ht()):Q||(()=>{if(it%_m.max(3*(30-et.et),30)==0){const t=[1.5*Xb(),Xb()-.5];t[1]=_m.sign(t[1])+t[1],Xb()>.5&&t.reverse();const e=_m.max(2*_m.min((et.et-3)/20,1),0)+1;st.push(new Y({x:t[0]*K.width,y:t[1]*K[_t.h],St:et,st:Xa(_m.pow(Xb(),2)*e+1)}))}it++,et.update(st,it),Z.update(et),tt.dx=et.ft,tt.dy=et.wt,tt.update(),st[_t.l](t=>{t.dx=et.ft,t.dy=et.wt,t.update(st)}),200===et.tt&&_s(()=>{st=[],V=new G(et,1)},3e3)})(),et.x=K.width/2,et.y=K[_t.h]/2},h:()=>{tt.h(),st[_t.l](t=>t.h()),et.h(),Z.h(),V?V.h():Q&&(0===Z.R.length&&(Q=0),Z.K(Q),v("space")?rt&&(rt=0,Z.V()):rt=1,Z.update(et)),nt&&nt.h()}});K[_t.e]("eh",({detail:t})=>{st.splice(st.indexOf(t),1),et.st<=0&&(V=new G(et,0))}),ot.start(),_s(()=>nt=null,6e3);};lis();
