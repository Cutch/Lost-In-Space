function lis(){const _t={"a":"right","b":"#fff","c":"24px Arial","d":"center","e":"addEventListener","f":"prototype","g":"position","h":"height","i":"fillStyle","j":"fillRect","k":"canvas","l":"forEach","m":"statusText","n":"createOscillator","o":"exponentialRampToValueAtTime","p":"currentTime","q":"background"};const _s=setTimeout;const _m=Math;const Xb=_m.floor;const Xa=_m.random;const _d=document;const _a=window[_t.e];let t,e,s={};function i(t,...e){(s[t]||[]).map(t=>t(...e))}function h(){return e}const n=()=>{};class r{constructor(t=0,e=0,s={}){this.x=t,this.y=e}add(t){return new r(this.x+t.x,this.y+t.y,this)}}function o(){return new r(...arguments)}o[_t.f]=r[_t.f],o.t=r;class a extends class{constructor(t){return this.init(t)}init(t={}){this[_t.g]=o(),this.s=o(),Object.assign(this,t)}update(t){this.advance(t)}advance(t){let e=this.s;this[_t.g]=this[_t.g].add(e),this.i()}get dx(){return this.s.x}get dy(){return this.s.y}set dx(t){this.s.x=t}set dy(t){this.s.y=t}i(){}}{init({width:t=0,height:e=0,_c:s=h(),h:i=this.o,update:n=this.advance,anchor:r={x:0,y:0},_r:o=0,...a}={}){super.init({width:t,height:e,_c:s,anchor:r,_r:o,...a}),this.l=1,this.u(),this.p=i,this.g=n}h(t){let e=this._c;e.save(),(this.x||this.y)&&e.translate(this.x,this.y),this._r&&e.rotate(this._r);let s=-this.width*this.anchor.x,i=-this[_t.h]*this.anchor.y;(s||i)&&e.translate(s,i),this.p(),(s||i)&&e.translate(-s,-i),e.restore()}o(){}i(t,e){this.u()}get x(){return this[_t.g].x}get y(){return this[_t.g].y}set x(t){this[_t.g].x=t,this.i()}set y(t){this[_t.g].y=t,this.i()}get width(){return this.M}set width(t){this.M=t,this.i()}get height(){return this.m}set height(t){this.m=t,this.i()}u(){if(!this.l)return;let{A:t=0,S:e=0,v:s=0}=this.parent||{};this.A=this.x,this.S=this.y,this.C=this.width,this.k=this[_t.h],this.v=s+this._r;let{x:i,y:h}=function(t,e){let s=_m.sin(e),i=_m.cos(e);return{x:t.x*i-t.y*s,y:t.x*s+t.y*i}}({x:this.x,y:this.y},s);this.A=i,this.S=h}get T(){return{x:this.A,y:this.S,width:this.C,height:this.k,_r:this.v}}get _r(){return this._}set _r(t){this._=t,this.i()}}function c(){return new a(...arguments)}c[_t.f]=a[_t.f],c.t=a;class l extends c.t{init({...t}={}){super.init({...t})}o(){this.color&&(this._c[_t.i]=this.color,this._c[_t.j](0,0,this.width,this[_t.h]))}}function u(){return new l(...arguments)}u[_t.f]=l[_t.f],u.t=l;let d=/(\d+)(\w+)/;class f extends c.t{init({text:t="",textAlign:e="",lh:s=1,font:i=h().font,...n}={}){super.init({text:t,textAlign:e,lh:s,font:i,...n}),this.H()}get width(){return this.M}set width(t){this.I=1,this.M=t,this.$=t}get text(){return this.F}set text(t){this.I=1,this.F=t}get font(){return this.D}set font(t){this.I=1,this.D=t,this.W=function(t){let e=t.match(d),s=+e[1];return{size:s,P:e[2],L:s}}(t).L}get lh(){return this.U}set lh(t){this.I=1,this.U=t}h(){this.I&&this.H(),super.h()}H(){this.q=[],this.I=0;let t=this._c;t.font=this.font,this.q.length||(this.q.push(this.text),this.M=this.$||t.measureText(this.text).width),this[_t.h]=this.W+(this.q.length-1)*this.W*this.lh,this.u()}o(){let t=this.textAlign,e=this._c;this.q.map((s,i)=>{e.textBaseline="top",e.textAlign=t,e[_t.i]=this.color,e.font=this.font,e.fillText(s,0,this.W*this.lh*i)})}}function w(){return new f(...arguments)}function p(t){let e=t[_t.k];t.clearRect(0,0,e.width,e[_t.h])}w[_t.f]=f[_t.f],w.t=f;let x={},g={},M={Enter:"enter",Escape:"esc",Space:"space"};function y(t){let e=M[t.code];g[e]=1,x[e]&&x[e](t)}function m(t){g[M[t.code]]=0}function A(){g={}}function S(t){return!!g[t]}const v=(t,e)=>_m.sqrt(_m.pow(t.x-e.x,2)+_m.pow(t.y-e.y,2)),C=(t,e)=>_m.sqrt(_m.pow(t,2)+_m.pow(e,2)),k=(t,e)=>_m.atan2(e.y-t.y,e.x-t.x)+_m.PI/2,T="Fire Rate Upgrade",E="Speed Upgrade",_="Hull Repaired",H="Warp Drive Fixed, Warping in 3, 2, 1...",b=t=>Array.apply(null,Array(t)).map((t,e)=>e),I=({width:t,height:e})=>{const s=[1.5*Xa(),Xa()-.5];return s[1]=_m.sign(s[1])+s[1],Xa()>.5&&s.reverse(),s[0]*=t,s[1]*=e,s};class $ extends c.t{R=[];constructor(t){super(t)}o(){const{_c:t}=this;t[_t.i]="#000",t[_t.j](-this.x,-this.y,t[_t.k].width,t[_t.k][_t.h]),t[_t.i]=_t.b,b(Xb(t[_t.k].width*t[_t.k][_t.h]*1e-4))[_t.l](e=>t[_t.j](-this.x+(this.x+(2*_m.pow(e,3)+20*e))%t[_t.k].width,-this.y+(this.y+(2*_m.pow(e,3)+20*e))%t[_t.k][_t.h],e%3+1,e%3+1))}update(t){if(super.update(),this.R[_t.l]((e,s)=>{e.update(),t-e.N>300&&this.R.splice(s,1)}),t%300==0){const[i,h]=I(this._c[_t.k]);this.R.push(new u({color:_t.b,x:i,y:h,width:2,height:4,N:t,dx:7*-_m.sign(i),dy:7*-_m.sign(h),_r:(e={x:i,y:h},s={x:-i,y:-h},_m.atan2(s.y-e.y,s.x-e.x)+_m.PI/2)}))}var e,s}h(){super.h(),this.R[_t.l](t=>t.h())}}const F={font:_t.c,color:_t.b,textAlign:_t.a};class D extends c.t{O=[];X=1;Y=0;constructor(t){super(t);this.j=new w(F),this.B=new w(F),this.G=new w(F),this.K=new w({font:"12px Arial",color:_t.b,text:"Press SPACE to skip"}),this.J=new u({color:"#6009"})}V(t){this.Y=t}h(){const t=this;t.j.h(),t.B.h(),t.G.h(),t[_t.m]&&(t.J.h(),t[_t.m].h(),t.Y&&t.K.h())}Z(t,e=6e3){this.O.push([t,e]),this[_t.m]||this.tt()}tt(){if(clearTimeout(this.et),this.O.length>0){const[t,e]=this.O.shift();this[_t.m]=new w({font:_t.c,color:_t.b,text:t,textAlign:_t.d,x:this._c[_t.k].width/2,y:20}),this.et=_s(()=>this.tt(),e)}else this[_t.m]=null}update(t){const e=this,s=e._c[_t.k].width,i=e._c[_t.k][_t.h];e.j.x=s-20,e.j.y=i-20-24,e.B.x=s-20,e.B.y=i-45-20-24,e.G.x=s-20,e.G.y=i-90-20-24,e.B.text=`Scrap: ${t.st}t`,e.j.text="Day: "+t.it,e.G.text=`Hull Integrity: ${t.ht}%`,e[_t.m]&&(e.J.width=s,e.J[_t.h]=64,e[_t.m].x=s/2,e[_t.m].y=20,e.Y&&(e.K.x=s/2+150,e.K.y=47))}}class W extends u.t{constructor(t){super(t={...t,width:2,height:10,color:"#abab46",nt:0})}update(t){super.update(),t.filter(t=>(({x:t,y:e},{x:s,y:i,width:h,height:n})=>t>s-h/2&&t<s+h/2&&e>i-n/2&&e<i+n/2)(this,t))[_t.l](t=>{this.nt=1,t.rt(),t.ht<=0&&this._c[_t.k].dispatchEvent(new CustomEvent("eh",{detail:t}))})}}const L=window.AudioContext||window.webkitAudioContext;let P=()=>{},U=()=>{},q=()=>{},R=()=>{};if(L){const t=new L;let e,s,i;P=()=>{const e=t[_t.n]();e.type="square";const s=t.createGain();s.gain.value=.5,s.gain[_t.o](1e-4,t[_t.p]+.04),e.frequency.value=100,e.connect(s),s.connect(t.destination),e.start(),_s(()=>e.stop(),100)},U=()=>{const e=t[_t.n]();e.type="sawtooth";const s=t.createGain();s.gain.value=.5,s.gain[_t.o](1e-4,t[_t.p]+.15),e.frequency.value=50,e.connect(s),s.connect(t.destination),e.start(),_s(()=>e.stop(),150)},q=h=>{if(clearTimeout(i),e)s.cancelScheduledValues(t[_t.p]),s.setValueAtTime(.1,t[_t.p]);else{const i=t.createBiquadFilter();i.type=0,i.Q.value=20,e=[t[_t.n](),t[_t.n]()];const[n,r]=e;n.frequency.value=10*h,r.frequency.value=25,e[_t.l]((t,e)=>{t.type="triangle",t.connect(i),t.start(0)});const o=t.createGain();s=o.gain,s.value=.1,i.connect(o),o.connect(t.destination)}},R=()=>{s&&(s.setValueAtTime(s.value,t[_t.p]),s[_t.o](1e-5,t[_t.p]+.02)),i=_s(()=>{e&&e[_t.l](t=>t.stop()),e=null},20)},_a("keydown",()=>{t.resume()})}const z=[30,0,22.5,15,20,30,0,45,0,57,15,60,45,60,60,57,60,45,40,30,37.5,15],N=(t,e,s,i,h,n,r=h)=>{t.beginPath(),t.moveTo(e,s),t.lineTo(i,h),t.lineTo(n,r),t.fill()};class O extends c.t{ot=4;at=0;ct=0;lt=[];ut=20;dt=-20;level=1;ft=1;it=0;st=0;wt=0;constructor(t){super({width:60,height:60,pt:0,xt:0,ht:100,anchor:{x:.5,y:.5}});const e=this,s=e._c;e.gt=t,e.Mt=s.createLinearGradient(0,0,0,80),e.Mt.addColorStop(.6,"#f00"),e.Mt.addColorStop(1,"#600"),e.color=this._c.createPattern((()=>{const t=_d.createElement("canvas"),e=t.getContext("2d");return t.width=60,t[_t.h]=60,e[_t.i]="#888",e[_t.j](0,0,60,60),e[_t.i]="#444",N(e,40,30,50,60,80),N(e,20,30,10,60,-20),e[_t.i]="#777",N(e,30,5,20,50,40),e[_t.i]="#666",N(e,30,5,20,40,40),e[_t.i]="#222",N(e,30,15,25,35,35),e[_t.i]="#AAA",b(4)[_t.l](t=>{N(e,10*t+15,50,10*t+10,60,10*t+20)}),t})(),"repeat"),e.yt=[[20,()=>e.ut=15,T],[40,()=>(e.ot=5.5,e.ft++),E],[60,()=>e.ut=10,T],[80,()=>(e.ot=6.5,e.ft++),E],[100,()=>e.ht=_m.min(100,e.ht+50),_],[120,()=>e.ut=5,T],[140,()=>(e.ot=7.5,e.ft++),E],[200,()=>e.at=1,H]],s[_t.k][_t.e]("eh",()=>{e.st++,e.yt[_t.l](([s,i,h])=>{s===e.st&&(e.level++,i(),t.Z(h))})})}o(){const t=this,e=t._c;e[_t.i]=t.color,e.beginPath();for(let t=0;t<z.length;t+=2)e.lineTo(z[t],z[t+1]);if(e.fill(),t.ct){e[_t.i]=t.Mt,e.beginPath();const s=Xa(),i=Xb(2*_m.pow(t.ot/2,2));b(13)[_t.l](h=>e.lineTo(15+t.width/2/12*h,60+h%2*(2*i-s*i*_m.sqrt(_m.abs(h/2-3))))),e.fill()}}h(){super.h(),this.lt[_t.l](t=>t.h())}update(t,e){const s=this;s.lt[_t.l]((i,h)=>{i.N<e-80||i.nt?s.lt.splice(h,1):i.update(t)}),s.it=Xb(e/600),t.filter(t=>v({x:s.x,y:s.y},t)<55)[_t.l](t=>{U(),s.ht-=10,s._c[_t.k].dispatchEvent(new CustomEvent("eh",{detail:t}))});const i=s.ct;if(s.ct=S("w"),s.ct&&!i?q(s.ft):!s.ct&&i&&R(),S("space")&&e-s.dt>=s.ut&&(P(),s.dt=e,s.At(e)),S("w")){s.pt+=.05*-_m.sin(s._r),s.xt+=.05*_m.cos(s._r);const t=C(s.pt,s.xt);t>s.ot&&(s.pt*=s.ot/t,s.xt*=s.ot/t)}const h=.05/(this.wt?1:2);S("a")?(s._r=s._r-h,this.wt=1):S("d")?(s._r=s._r+h,this.wt=1):this.wt=0}At(t){this.lt.push(new W({dx:10*_m.sin(this._r),dy:10*-_m.cos(this._r),x:this.x+40*_m.sin(this._r),y:this.y-40*_m.cos(this._r),_r:this._r,N:t}))}}const X=(t,e)=>{const s=_d.createElement("canvas"),i=s.getContext("2d");s.width=40,s[_t.h]=40,i[_t.i]=t,i[_t.j](0,0,40,40);const h=(n=e+1,()=>(n=1e4*_m.sin(n))-Xb(n));var n;for(let t=0,e=0;e<40;){const s=Xb(7*h()+2);i[_t.i]=h()<.5?"#333":"#222",i[_t.j](t,e,s,Xb(7*h()+2)),t+=1+s,t>40&&(e+=5,t=0)}return s},Y=b(15).reduce((t,e)=>[...t,...["#080","#008","#800"].map(t=>X(t,e))],[]);class j extends u.t{constructor(t){super(t={...t,width:40,height:40,pt:0,xt:0,anchor:{x:.5,y:.5}}),this.type=3*Xb(15*Xa()),this.St=Y.map(t=>this._c.createPattern(t,null)),this.ht++,this.rt()}rt(){this.ht--,this.ht>0&&(this.color=this.St[this.ht-1+this.type])}update(t){const e=this,s=t.reduce((t,s)=>{if(s!==e){const i=v(e,s);if(i<t.vt){return{angle:k(e,s)+180,vt:i}}}return t},{vt:100,angle:0});let i=k(e,e.Ct);100!==s.vt&&(i=s.angle+i/2),e.pt-=.1*_m.sin(i),e.xt+=.1*_m.cos(i);const h=C(e.pt,e.xt),n=e.Ct.it,r=_m.min(n/8,5)+5;h>r&&(e.pt*=r/h,e.xt*=r/h),e.dx-=e.pt,e.dy-=e.xt,super.update()}}const B="36px Arial",G=t=>1!==t?"s":"";class K extends c.t{kt=0;constructor(t,e){super(),R();const s=this;s[_t.q]=new u({width:600,height:400,color:"#600A"}),s.Tt=new w({font:_t.c,color:_t.b,text:"Me: These are the coordinates, where's Earth?",textAlign:_t.d}),s.Et=new w({font:_t.c,color:_t.b,text:"Computer: Error: 404. Earth not found.",textAlign:_t.d}),s._t=new w({font:B,color:_t.b,text:"Game Over",textAlign:_t.d}),s.Ht=new w({font:B,color:_t.b,text:"Score: "+t.st,textAlign:_t.d});const i=window.localStorage;if(i){const e=_m.max(i.getItem("lins_score")||0,t.st),h=i.getItem("lins_day")||0,n=t.st>=200?_m.min(h,t.it):h;i.setItem("lins_score",e),i.setItem("lins_day",h),s.bt=new w({font:"18px Arial",color:_t.b,text:`High Score: ${n} day${G(n)}, ${e} scrap`,textAlign:_t.d})}s.j=new w({font:B,color:_t.b,text:`${e?"Completed in":"Lasted"}: ${t.it} day${G(t.it)}`,textAlign:_t.d}),s.It=new w({font:B,color:_t.b,text:"Play Again? Press Enter",textAlign:_t.d}),s.kt=e}h(){const t=this;t[_t.q].h(),t.kt?(t.Tt.h(),t.Et.h()):t._t.h(),t.Ht.h(),t.j.h(),t.bt&&t.bt.h(),t.It.h()}update(){const t=this,e=t._c[_t.k].width/2,s=t._c[_t.k][_t.h]/2;t[_t.q].x=e-t[_t.q].width/2,t[_t.q].y=s-t[_t.q][_t.h]/2,t.Tt.x=e,t.Tt.y=s-132,t.Et.x=e,t.Et.y=s-104,t._t.x=e,t._t.y=s-112,t.Ht.x=e,t.Ht.y=s-56,t.j.x=e,t.j.y=s,t.bt&&(t.bt.x=e,t.bt.y=s+56),t.It.x=e,t.It.y=s+112}}const{canvas:J}=function(s){return t=_d.getElementById(s)||s||_d.querySelector("canvas"),e=t.getContext("2d"),e.$t=0,i("init"),{canvas:t,_c:e}}();function Q(){const t=_d.getElementsByTagName("canvas")[0];t.width=window.innerWidth,t[_t.h]=window.innerHeight}_a("resize",Q,0),Q(),function(){let t;for(t=0;t<26;t++)M[t+65]=M["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)M[48+t]=M["Digit"+t]=""+t;_a("keydown",y),_a("keyup",m),_a("blur",A)}();let V=new w({color:"#600D",font:"70px Arial",textAlign:_t.d,text:"Lost In Space",x:J.width/2,y:J[_t.h]/4});const Z=new w({font:"36px Arial",color:_t.b,text:"Paused",textAlign:_t.d});let tt,et,st,it,ht,nt,rt,ot;const at=()=>{tt=1,et=null,st=new D,it=new $,ht=new O(st),ot=0,rt=1,nt=[],["Me: Where am I?","Computer: Error: 404. Location Not Found.","Me: It looks like I have drifted for 10 warp days. I will have to find my way back.","Me: This may be Corg space, I don't want to get assimil...assinated.","Me: Computer, System Status.","Computer: All systems have been destroyed.","Me: Ugh, now I need some scrap to fix the systems.","Computer: 200t of scrap are needed","Computer: Use my WASD keys to fly and The Bar to shoot. ESC to stop time."][_t.l](t=>st.Z(t,_m.max(t.split(" ").length,6)/150*6e4))};at();let ct=1;let lt=1;const ut=function({Ft:t=60,Dt:e=1,update:s=n,h:r,_c:o=h()}={}){let a,c,l,u,d,f=0,w=1e3/t,x=1/t,g=e?p:n;function M(){if(c=requestAnimationFrame(M),l=performance.now(),u=l-a,a=l,!(u>1e3)){for(i("tick"),f+=u;f>=w;)d.update(x),f-=w;g(o),d.h()}}return d={update:s,h:r,Wt:1,start(){a=performance.now(),this.Wt=0,requestAnimationFrame(M)},stop(){this.Wt=1,cancelAnimationFrame(c)}},d}({Dt:0,update:()=>{et?(et.update(),S("enter")&&at()):tt||(()=>{if(S("esc")?ct&&(ct=0,ot=!ot):ct=1,!ot){if(rt%_m.max(3*(30-ht.it),30)==0){const[t,e]=I(J),s=_m.max(2*_m.min((ht.it-3)/20,1),0)+1;nt.push(new j({x:t,y:e,Ct:ht,ht:Xb(_m.pow(Xa(),2)*s+1)}))}rt++,ht.update(nt,rt),st.update(ht),it.dx=ht.pt,it.dy=ht.xt,it.update(rt),nt[_t.l](t=>{t.dx=ht.pt,t.dy=ht.xt,t.update(nt)}),200===ht.st&&_s(()=>{nt=[],et=new K(ht,1)},3e3)}})(),ht.x=J.width/2,ht.y=J[_t.h]/2,Z.x=ht.x,Z.y=ht.y,V&&(V.x=J.width/2,V.y=J[_t.h]/4)},h:()=>{it.h(),nt[_t.l](t=>t.h()),ht.h(),st.h(),ot?Z.h():et?et.h():tt&&(0===st.O.length&&(tt=0),st.V(tt),S("space")?lt&&(lt=0,st.tt()):lt=1,st.update(ht)),V&&V.h()}});J[_t.e]("eh",({detail:t})=>{nt.splice(nt.indexOf(t),1),ht.ht<=0&&(et=new K(ht,0))}),ut.start(),_s(()=>V=null,6e3);};lis();
