let t,i,s={};function h(t,...i){(s[t]||[]).map(t=>t(...i))}function e(){return i}const n=()=>{};class r{constructor(t=0,i=0,s={}){this.x=t,this.y=i}add(t){return new r(this.x+t.x,this.y+t.y,this)}}function o(){return new r(...arguments)}o.prototype=r.prototype,o.t=r;class a extends class{constructor(t){return this.init(t)}init(t={}){this.position=o(),this.i=o(),Object.assign(this,t)}update(t){this.advance(t)}advance(t){let i=this.i;this.position=this.position.add(i),this.s()}get dx(){return this.i.x}get dy(){return this.i.y}set dx(t){this.i.x=t}set dy(t){this.i.y=t}s(){}}{init({width:t=0,height:i=0,context:s=e(),h=this.o,update:n=this.advance,anchor:r={x:0,y:0},rotation:o=0,...a}={}){super.init({width:t,height:i,context:s,anchor:r,rotation:o,...a}),this.l=1,this.u(),this.p=h,this.g=n}h(t){let i=this.context;i.save(),(this.x||this.y)&&i.translate(this.x,this.y),this.rotation&&i.rotate(this.rotation);let s=-this.width*this.anchor.x,h=-this.height*this.anchor.y;(s||h)&&i.translate(s,h),this.p(),(s||h)&&i.translate(-s,-h),i.restore()}o(){}s(t,i){this.u()}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this.s()}set y(t){this.position.y=t,this.s()}get width(){return this.m}set width(t){this.m=t,this.s()}get height(){return this.M}set height(t){this.M=t,this.s()}u(){if(!this.l)return;let{A:t=0,S:i=0,v:s=0}=this.parent||{};this.A=this.x,this.S=this.y,this.k=this.width,this.C=this.height,this.v=s+this.rotation;let{x:h,y:e}=function(t,i){let s=Math.sin(i),h=Math.cos(i);return{x:t.x*h-t.y*s,y:t.x*s+t.y*h}}({x:this.x,y:this.y},s);this.A=h,this.S=e}get H(){return{x:this.A,y:this.S,width:this.k,height:this.C,rotation:this.v}}get rotation(){return this.T}set rotation(t){this.T=t,this.s()}}function c(){return new a(...arguments)}c.prototype=a.prototype,c.t=a;class l extends c.t{init({...t}={}){super.init({...t})}o(){this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}function d(){return new l(...arguments)}d.prototype=l.prototype,d.t=l;let u=/(\d+)(\w+)/;class f extends c.t{init({text:t="",textAlign:i="",lineHeight:s=1,font:h=e().font,...n}={}){super.init({text:t,textAlign:i,lineHeight:s,font:h,...n}),this._()}get width(){return this.m}set width(t){this.F=1,this.m=t,this.U=t}get text(){return this.I}set text(t){this.F=1,this.I=t}get font(){return this.$}set font(t){this.F=1,this.$=t,this.D=function(t){let i=t.match(u),s=+i[1];return{size:s,L:i[2],W:s}}(t).W}get lineHeight(){return this.R}set lineHeight(t){this.F=1,this.R=t}h(){this.F&&this._(),super.h()}_(){this.q=[],this.F=0;let t=this.context;t.font=this.font,this.q.length||(this.q.push(this.text),this.m=this.U||t.measureText(this.text).width),this.height=this.D+(this.q.length-1)*this.D*this.lineHeight,this.u()}o(){let t=this.textAlign,i=this.context;this.q.map((s,h)=>{i.textBaseline="top",i.textAlign=t,i.fillStyle=this.color,i.font=this.font,i.fillText(s,0,this.D*this.lineHeight*h)})}}function w(){return new f(...arguments)}function p(t){let i=t.canvas;t.clearRect(0,0,i.width,i.height)}w.prototype=f.prototype,w.t=f;let x={},g={},m={P:"enter",N:"esc",O:"space",X:"left",Y:"up",j:"right",B:"down"};function y(t){let i=m[t.code];g[i]=1,x[i]&&x[i](t)}function M(t){g[m[t.code]]=0}function A(){g={}}function S(t){return!!g[t]}class v extends c.t{constructor(t){super(t)}o(){this.context.fillStyle="#000",this.context.fillRect(-this.x,-this.y,this.context.canvas.width,this.context.canvas.height),this.context.fillStyle="#fff";for(let t=0;t<this.context.canvas.width*this.context.canvas.height*1e-4;t++)this.context.fillRect(-this.x+(this.x+(2*Math.pow(t,3)+20*t))%this.context.canvas.width,-this.y+(this.y+(2*Math.pow(t,3)+20*t))%this.context.canvas.height,t%3+1,t%3+1)}}const k={font:"24px Arial",color:"#fff",textAlign:"right"};class C extends c.t{G=[];K=1;J=0;constructor(t){super(t),this.V=new w(k),this.Z=new w(k),this.tt=new w(k),this.it=new w({font:"12px Arial",color:"#fff",text:"Press SPACE to skip"}),this.st=new d({color:"#6009"})}ht(t){this.J=t}h(){this.V.h(),this.Z.h(),this.tt.h(),this.statusText&&(this.st.h(),this.statusText.h(),this.J&&this.it.h())}et(t,i=6e3){this.G.push([t,i]),this.statusText||this.nt()}nt(){if(clearTimeout(this.rt),this.G.length>0){const[t,i]=this.G.shift();this.statusText=new w({font:"24px Arial",color:"#fff",text:t,textAlign:"center",x:this.context.canvas.width/2,y:20}),this.rt=setTimeout(()=>this.nt(),i)}else this.statusText=null}update(t){const i=this.context.canvas.width,s=this.context.canvas.height;this.V.x=i-20,this.V.y=s-20-24,this.Z.x=i-20,this.Z.y=s-45-20-24,this.tt.x=i-20,this.tt.y=s-90-20-24,this.Z.text=`Scrap: ${t.ot}t`,this.V.text="Day: "+t.at,this.tt.text=`Hull Integrity: ${t.ct}%`,this.statusText&&(this.st.width=i,this.st.height=64,this.statusText.x=i/2,this.statusText.y=20,this.J&&(this.it.x=i/2+150,this.it.y=47))}}const H=(t,i)=>Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)),T=(t,i)=>Math.sqrt(Math.pow(t,2)+Math.pow(i,2)),E=(t,i)=>Math.atan2(i.y-t.y,i.x-t.x)+Math.PI/2;class _ extends d.t{constructor(t){super(t={...t,width:2,height:10,color:"#abab46",lt:0})}update(t){super.update(),t.filter(t=>(({x:t,y:i},{x:s,y:h,width:e,height:n})=>t>s-e/2&&t<s+e/2&&i>h-n/2&&i<h+n/2)(this,t)).forEach(t=>{this.lt=1,this.context.canvas.dispatchEvent(new CustomEvent("enemyHit",{detail:t}))})}}const F=new(window.AudioContext||window.webkitAudioContext);let U,b,I;const $=()=>{b.gain.setValueAtTime(b.gain.value,F.currentTime),b.gain.exponentialRampToValueAtTime(1e-5,F.currentTime+.02),I=setTimeout(()=>{U&&U.forEach(t=>t.stop()),U=null},20)};document.addEventListener("keydown",()=>{F.resume()});class D extends c.t{dt=4;ut=0;ft=0;wt=[];pt=20;xt=-20;level=1;gt=1;at=0;ot=0;yt=[[20,()=>this.pt=15,"Fire Rate Upgrade"],[40,()=>(this.dt=5,this.gt++),"Speed Upgrade"],[60,()=>this.pt=10,"Fire Rate Upgrade"],[80,()=>(this.dt=6,this.gt++),"Speed Upgrade"],[100,()=>this.pt=5,"Fire Rate Upgrade"],[120,()=>(this.dt=7,this.gt++),"Speed Upgrade"],[200,()=>this.ut=1,"Warp Drive Fixed, Warping in 3, 2, 1..."]];constructor(t){super({width:60,height:60,Mt:30,At:30,St:0,vt:0,ct:100});const i=this.context;this.kt=t,this.Ct=i.createLinearGradient(0,this.At,0,this.At+20),this.Ct.addColorStop(0,"#f00"),this.Ct.addColorStop(.5,"#600"),this.Ht=i.createLinearGradient(-40,0,40,0),this.Ht.addColorStop(0,"#000"),this.Ht.addColorStop(.5,"#fff"),this.Ht.addColorStop(1,"#000"),this.Tt=[0,-this.At,-this.Mt/4,-this.At/2,-this.Mt/3,0,-this.Mt,this.At/2,-this.Mt,.9*this.At,-this.Mt/2,this.At,this.Mt/2,this.At,this.Mt,.9*this.At,this.Mt,this.At/2,this.Mt/3,0,this.Mt/4,-this.At/2],i.canvas.addEventListener("enemyHit",()=>{this.ot++,this.yt.forEach(([i,s,h])=>{i===this.ot&&(this.level++,s(),t.et(h))})})}o(){const t=this.context;t.fillStyle=this.Ht,t.beginPath();for(let i=0;i<this.Tt.length;i+=2)t.lineTo(this.Tt[i],this.Tt[i+1]);if(t.fill(),this.ft){t.fillStyle=this.Ct,t.beginPath();const i=Math.random();for(let s=0;s<=12;s++)this.dt,t.lineTo(-this.Mt/2+this.width/2/12*s,this.At+s%2*(4*this.dt-i*this.dt*2*Math.sqrt(Math.abs(s/2-3))));t.fill()}}h(){super.h(),this.wt.forEach(t=>t.h())}update(t,i){this.wt.forEach((s,h)=>{s.Et<i-60||s.lt?this.wt.splice(h,1):s.update(t)}),this.at=Math.floor(i/1200),t.filter(t=>H({x:this.x,y:this.y},t)<55).forEach(t=>{this.ct-=10,this.context.canvas.dispatchEvent(new CustomEvent("enemyHit",{detail:t}))});const s=this.ft;if(this.ft=S("w"),this.ft&&!s?(t=>{if(clearTimeout(I),U)b.gain.cancelScheduledValues(F.currentTime),b.gain.setValueAtTime(.05,F.currentTime);else{const i=F.createBiquadFilter();i.type=0,i.Q.value=20,U=[F.createOscillator(),F.createOscillator()];const[s,h]=U;s.frequency.value=10*t,h.frequency.value=25,U.forEach((t,s)=>{t.type="triangle",t.connect(i),t.start(0)}),b=F.createGain(),b.gain.value=.05,i.connect(b),b.connect(F.destination)}})(this.gt):!this.ft&&s&&$(),S("space")&&i-this.xt>=this.pt&&((()=>{const t=F.createOscillator();t.type="square";const i=F.createGain();i.gain.exponentialRampToValueAtTime(1e-4,F.currentTime+.04),t.frequency.value=100,t.connect(i),i.connect(F.destination),t.start(),setTimeout(()=>t.stop(),100)})(),this.xt=i,this._t(i)),S("w")){this.St+=.05*-Math.sin(this.rotation),this.vt+=.05*Math.cos(this.rotation);const t=T(this.St,this.vt);t>this.dt&&(this.St*=this.dt/t,this.vt*=this.dt/t)}S("a")&&(this.rotation=this.rotation-.05),S("d")&&(this.rotation=this.rotation+.05)}_t(t){this.wt.push(new _({dx:10*Math.sin(this.rotation),dy:10*-Math.cos(this.rotation),x:this.x+40*Math.sin(this.rotation),y:this.y-40*Math.cos(this.rotation),rotation:this.rotation,Et:t}))}}class W extends d.t{constructor(t){super(t={...t,width:40,height:40,color:"green",St:0,vt:0,anchor:{x:.5,y:.5}})}update(t){const i=t.reduce((t,i)=>{if(i!==this){const s=H(this,i);if(s<t.Ft)return{angle:E(this,i)+180,Ft:s}}return t},{Ft:100,angle:0});let s=E(this,this.Ut);100!==i.Ft&&(s=i.angle+s/2),this.St-=.1*Math.sin(s),this.vt+=.1*Math.cos(s);const h=T(this.St,this.vt),e=this.Ut.at,n=Math.min(e/2,10)+5;h>n&&(this.St*=n/h,this.vt*=n/h),this.dx-=this.St,this.dy-=this.vt,super.update()}}const L="36px Arial",R=t=>1!==t?"s":"";class q extends c.t{bt=0;constructor(t,i){if(super(),$(),this.background=new d({width:600,height:400,color:"#600A"}),this.It=new w({font:"24px Arial",color:"#fff",text:"Me: These are the coordinates, where's Earth?",textAlign:"center"}),this.$t=new w({font:"24px Arial",color:"#fff",text:"Computer: Error: 404. Earth not found.",textAlign:"center"}),this.Dt=new w({font:L,color:"#fff",text:"Game Over",textAlign:"center"}),this.Wt=new w({font:L,color:"#fff",text:"Score: "+t.ot,textAlign:"center"}),window.localStorage){const i=Math.max(localStorage.getItem("lins_score")||0,t.ot),s=Math.max(localStorage.getItem("lins_day")||0,t.at);localStorage.setItem("lins_score",i),localStorage.setItem("lins_day",s),this.Lt=new w({font:"18px Arial",color:"#fff",text:`High Score: ${s} day${R(s)}, ${i} scrap`,textAlign:"center"})}this.V=new w({font:L,color:"#fff",text:`${i?"Completed in":"Lasted"}: ${t.at} day${R(t.at)}`,textAlign:"center"}),this.Rt=new w({font:L,color:"#fff",text:"Play Again? Press Enter",textAlign:"center"}),this.bt=i}h(){this.background.h(),this.bt?(this.It.h(),this.$t.h()):this.Dt.h(),this.Wt.h(),this.V.h(),this.Lt&&this.Lt.h(),this.Rt.h()}update(){const t=this.context.canvas.width/2,i=this.context.canvas.height/2;this.background.x=t-this.background.width/2,this.background.y=i-this.background.height/2,this.It.x=t,this.It.y=i-132,this.$t.x=t,this.$t.y=i-104,this.Dt.x=t,this.Dt.y=i-112,this.Wt.x=t,this.Wt.y=i-56,this.V.x=t,this.V.y=i,this.Lt&&(this.Lt.x=t,this.Lt.y=i+56),this.Rt.x=t,this.Rt.y=i+112}}const{canvas:P}=(t=document.getElementById(void 0)||document.querySelector("canvas"),i=t.getContext("2d"),i.qt=0,h("init"),{canvas:t,context:i});function z(){const t=document.getElementsByTagName("canvas")[0];t.width=window.innerWidth,t.height=window.innerHeight}window.addEventListener("resize",z,0),z(),function(){let t;for(t=0;t<26;t++)m[t+65]=m["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)m[48+t]=m["Digit"+t]=""+t;window.addEventListener("keydown",y),window.addEventListener("keyup",M),window.addEventListener("blur",A)}();let N,O,X,Y,j,B,G,K=new w({color:"#600D",font:"70px Arial",textAlign:"center",text:"Lost In Space",x:P.width/2,y:P.height/4});const J=()=>{N=1,O=null,X=new C,Y=new v,j=new D(X),G=1,B=[],["Me: Where am I?","Computer: Error: 404. Location Not Found.","Me: It looks like I have drifted for 10 warp days. I will have to find my way back.","Me: This may be Corg space, I don't want to get assimil...assinated.","Me: Computer, System Status.","Computer: All critical have been destroyed.","Me: Ugh, now I need some scrap to fix the systems.","Computer: Use my WASD keys to fly and The Bar to shoot."].forEach(t=>X.et(t,Math.max(t.split(" ").length,6)/150*6e4))};J();let Q=1;const V=function({Pt:t=60,zt:i=1,update:s=n,h:r,context:o=e()}={}){let a,c,l,d,u,f=0,w=1e3/t,x=1/t,g=i?p:n;function m(){if(c=requestAnimationFrame(m),l=performance.now(),d=l-a,a=l,!(d>1e3)){for(h("tick"),f+=d;f>=w;)u.update(x),f-=w;g(o),u.h()}}return u={update:s,h:r,Nt:1,start(){a=performance.now(),this.Nt=0,requestAnimationFrame(m)},stop(){this.Nt=1,cancelAnimationFrame(c)}},u}({zt:0,update:()=>{O?(O.update(),S("enter")&&J()):N||(()=>{if(G%Math.min(60*(10-j.at),60)==0){let t=Math.random()-.5;t=Math.sign(t)+t;let i=Math.random()-.5;i=Math.sign(i)+i,B.push(new W({x:t*P.width,y:i*P.height,Ut:j}))}G++,j.update(B,G),X.update(j),Y.dx=j.St,Y.dy=j.vt,Y.update(),B.forEach(t=>{t.dx=j.St,t.dy=j.vt,t.update(B)}),200===j.ot&&setTimeout(()=>O=new q(j,1),3e3)})(),j.x=P.width/2,j.y=P.height/2},h:()=>{Y.h(),B.forEach(t=>t.h()),j.h(),X.h(),O?O.h():N&&(0===X.G.length&&(N=0),X.ht(N),S("space")?Q&&(Q=0,X.nt()):Q=1,X.update(j)),K&&K.h()}});P.addEventListener("enemyHit",({detail:t})=>{B.splice(B.indexOf(t),1),j.ct<=0&&(O=new q(j,0))}),V.start(),setTimeout(()=>K=null,6e3);
